jQuery(function($){function e(e){e.click(function(e){formID=$(this).attr("rel"),formfield=$(this).siblings(".meta_box_upload_file"),preview=$(this).siblings(".meta_box_filename"),icon=$(this).siblings(".meta_box_file"),tb_show("Choose File","media-upload.php?post_id="+formID+"&type=file&TB_iframe=1"),window.orig_send_to_editor=window.send_to_editor,window.send_to_editor=function(e){fileurl=$(e).attr("href"),formfield.val(fileurl),preview.text(fileurl),icon.addClass("checked"),tb_remove(),window.send_to_editor=window.orig_send_to_editor}})}function t(e){e.click(function(){var e,t;if(void 0!==e)return void e.open();e=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",multiple:!1});var o=$(this).attr("rel");formfield=$(this).siblings(".meta_box_upload_image"),preview=$(this).siblings(".meta_box_preview_image"),e.on("insert",function(){json=e.state().get("selection").first().toJSON(),console.log("imgurl:"+json.url),console.log("id:"+json.id),imgurl=json.url,id=json.id,preview.attr("src",imgurl),formfield.val(id)}),e.open()})}function o(e){e.click(function(){var e=$(this).parent().siblings(".meta_box_default_image").text();return $(this).parent().siblings(".meta_box_upload_image").val(""),$(this).parent().siblings(".meta_box_preview_image").attr("src",e),!1})}function i(){$(".qw-conditional-fields").each(function(){var e="";$(this).find("option:selected").each(function(){$(this).attr("data-tohide")&&($.toHideArray=$(this).attr("data-tohide").split("[+]"),$.toHideArray.length>0&&$.each($.toHideArray,function(e,t){$(t).not("qw-hidden")&&$(t).addClass("qw-hidden")})),$(this).attr("data-toreveal")&&($.toRevealArray=$(this).attr("data-toreveal").split("[+]"),$.toRevealArray.length>0&&$.each($.toRevealArray,function(e,t){$(t).removeClass("qw-hidden")}))})})}function a(){function e(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o].val)}t($(".meta_box_upload_image_button")),o($(".meta_box_clear_image_button")),$(".meta_box_clear_file_button").click(function(){return $(this).parent().siblings(".meta_box_upload_file").val(""),$(this).parent().siblings(".meta_box_filename").text(""),$(this).parent().siblings(".meta_box_file").removeClass("checked"),!1}),$(".meta_box_repeatable_remove").live("click",function(){return $(this).closest("tr").remove(),!1}),$(".meta_box_repeatable tbody").sortable({opacity:.6,revert:!0,cursor:"move",handle:".hndle"}),$(".sort_list").sortable({connectWith:".sort_list",opacity:.6,revert:!0,cursor:"move",cancel:".post_drop_sort_area_name",items:"li:not(.post_drop_sort_area_name)",update:function(e,t){var o=$(this).sortable("toArray"),i=$(this).attr("id");$(".store-"+i).val(o)}}),$(".sort_list").disableSelection(),$.prototype.chosen&&$(".chosen").chosen({allow_single_deselect:!0})}$("input").bind("invalid",function(){return alert("invalid"),!1}),jQuery(document).ready(function($){$(".meta_box_color").wpColorPicker()}),i(),$(".qw-conditional-fields").change(function(){i()}),a(),e($(".meta_box_upload_file_button")),$(".meta_box_repeatable_add").live("click",function(i){i.preventDefault();var a=$(this).closest(".meta_box_repeatable").find("tbody tr:last-child"),n=a.clone();n.find("select.chosen").removeAttr("style","").removeAttr("id","").removeClass("chzn-done").data("chosen",null).next().remove(),n.find("input.regular-text, textarea, select, .meta_box_upload_file ").val(""),n.find("input[type=checkbox], input[type=radio]").attr("checked",!1),n.find("span.meta_box_filename").html("");var r=n.find(".meta_box_upload_file_button"),l=n.find(".meta_box_upload_image_button"),s=n.find(".meta_box_clear_image_button");n.find("img.meta_box_preview_image").attr("src",""),e(r),t(l),o(s),a.after(n),n.find("input, textarea, select").attr("name",function(e,t){return t.replace(/(\d+)/,function(e,t){return Number(t)+1})});var d=[];return $("input.repeatable_id:text").each(function(){d.push($(this).val())}),n.find("input.repeatable_id").val(Number(Math.max.apply(Math,d))+1),$.prototype.chosen&&n.find("select.chosen").chosen({allow_single_deselect:!0}),!1}),$("a.qw-iconreference-open").click(function(e){e.preventDefault(),$("body").addClass("qwModalFormOpen"),$("#qwModalForm").height($(window).height()),$.iconTarget=$(this).attr("data-target"),$("#adminmenuwrap").css({"z-index":"10"})}),$("#qw-closemodal").on("click",function(e){$("body").removeClass("qwModalFormOpen"),$("#adminmenuwrap").css({"z-index":"1000"})}),$("#qwiconsMarket").on("click",".btn",function(e){e.preventDefault();var t=$(this).attr("data-icon");if(void 0!=$.iconTarget){var o=$.iconTarget;console.log(o),"tinymce"!==o?($("#"+$.iconTarget).val(t),$("#theIcon"+$.iconTarget).removeClass().addClass(t+" bigicon")):tinymce.activeEditor.execCommand("mceInsertContent",!1,'[qticon class="'+t+'" size="s|m|l|xl|xxl"]'),$("body").removeClass("qwModalFormOpen"),$("#adminmenuwrap").css({"z-index":"1000"})}}),$(".qw_hider").click(function(e,t){var o=$(this);$(".qw_hiddenable").addClass("qw-hide").promise().done(function(){$(".qw_hiddenable .qw_hider").addClass("dashicons-hidden").removeClass("dashicons-visibility"),o.closest(".qw_hiddenable").removeClass("qw-hide"),o.removeClass("dashicons-hidden").addClass("dashicons-visibility")})}),$(".geocodefunction").click(function(e,t){var o=$(this),i=o.attr("data-target"),a=$("#address-"+i).attr("value"),n=$("#results-"+i),r=new google.maps.Geocoder,l=$("#map-"+i);r.geocode({address:a},function(e,t){if(t===google.maps.GeocoderStatus.OK){l.height("180px");var o=new google.maps.Map(document.getElementById("map-"+i),{zoom:10,center:{lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng()}});o.setCenter(e[0].geometry.location);var a=new google.maps.Marker({map:o,position:e[0].geometry.location}),e=e[0].geometry.location.lat()+","+e[0].geometry.location.lng();n.html(""),$("#"+i).attr("value",e)}else n.html("Geocode was not successful for the following reason: "+t)})}),$(".qt-tabs .qt-tabnav a").click(function(e){e.preventDefault();var t=$(this),o=t.attr("href");console.log(o),t.closest(".qt-tabs").find(".qt-tab.active").removeClass("active"),$(o).addClass("active")})});